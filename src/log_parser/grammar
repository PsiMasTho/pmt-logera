%token-path ../log_scanner/log_token_enums.h

%scanner ../log_scanner/log_scanner.h
%scanner-class-name LogScanner

%token IDENT
%token DATE
%token VAR

%stype std::string

%%

input:
    // empty
|
    input line
;

line:
    date '\n'
    {
       d_logDataModifier.setDate(Date($1));
    }
|
    variable '\n'
|
    assign_vals_to_attrs '\n'
|
    '\n'
;

date:
    DATE
    {
        $$ = d_scanner.matched();
    }
;

variable:
    VAR
    {
        string txt = d_scanner.matched();
        txt.pop_back(); // ':'
        d_logDataModifier.startNewLineForNewVar(txt);
    }
;

identifier:
    IDENT
    {
        $$ = d_scanner.matched();
    }
;

assign_vals_to_attrs:
    identifier identifier ';'
    {
        d_logDataModifier.addAttrToCurrentLine($1, $2);
    }
|
    assign_vals_to_attrs identifier identifier ';'
    {
        d_logDataModifier.addAttrToCurrentLine($2, $3);
    }
;